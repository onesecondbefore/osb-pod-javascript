!function(){"use strict";var n=(new Date).getTime(),c={log:function c(e){console!==undefined&&console.log((new Date).getTime()-n+" "+e)},warn:function(e){console!==undefined&&console.warn((new Date).getTime()-n+" "+e)},debug:function(e){},group:function(){console!==undefined&&console.group!==undefined&&console.group()},groupEnd:function(){console!==undefined&&console.groupEnd!==undefined&&console.groupEnd()}},f={isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},isObject:function(e){return e&&e.constructor===Object},isEmpty:function(e){for(var n in e)if(e.hasOwnProperty(n))return!1;return JSON.stringify(e)===JSON.stringify({})},mergeRecursive:function(){for(var e={},n=0;n<arguments.length;n++){var t=arguments[n];for(var o in t)if(t.hasOwnProperty(o))try{this.isObject(t[o])?e[o]=this.mergeRecursive(e[o],t[o]):this.isArray(t[o])&&this.isArray(e[o])?e[o]=e[o].concat(t[o]):e[o]=t[o]}catch(i){e[o]=t[o]}}return e},args2array:function(){for(var e=[],n=0;n<arguments.length;n++)e.push(arguments[n]);return e},jsonToQS:function(e,n,t){var o=[];if(this.isArray(e)){for(var i=0;i<e.length;i++)o.push(this.jsonToQS(e[i],n,t));return o.join("&")}if(this.isObject(e)){for(var r in e)e.hasOwnProperty(r)&&o.push(this.jsonToQS(e[r],t,r));return o.join("&")}return n?encodeURIComponent(n)+"["+encodeURIComponent(t)+"]="+encodeURIComponent(e):t?encodeURIComponent(t)+"="+encodeURIComponent(e):encodeURIComponent(e)}},t={trackers:[],payloads:[]};function o(e){var n=new RegExp("(^|;)[ ]*"+e+"=([^;]*)").exec(document.cookie);return c.log("Cookie "+e+" = "+n),!!n&&window.decodeURIComponent(n[2])}function i(e,n,t,o,i,r){var a=new Date;0<t&&a.setTime(a.getTime()+t),document.cookie=e+"="+window.decodeURIComponent(n)+(t?";expires="+a.toUTCString():"")+";path="+(o||"/")+(i?";domain="+i:"")+(r?";secure":"")}var l={getCookie:o,setCookie:i,acceptsCookies:function q(){if(navigator.cookieEnabled===undefined){var e=t.cookieNamePrefix+"testcookie";i(e,"1",undefined,undefined,undefined,undefined),navigator.cookieEnabled="1"===o(e)}return navigator.cookieEnabled}};function g(e){try{window.localStorage!==undefined&&window.localStorage.setItem(e.cookieNamePrefix+"cduid",e.crossDomainUserId)}catch(n){console.debug(n)}0<e.cookieSettings?(l.setCookie(e.cookieNamePrefix+"cduid",e.crossDomainUserId,e.userCookieTimeout,e.cookiePath,e.cookieDomain,undefined),"function"==typeof e.cduidLoaded?(c.log("Triggering cduidLoaded() callback with CDUID ",e.crossDomainUserId),e.cduidLoaded(e.crossDomainUserId)):e.cduidLoaded!==undefined&&c.warn("cduidLoaded() callback incorrect type, should be function")):"function"!=typeof e.cduidLoaded&&c.warn("Cookie settings don't allow cduidLoaded() callback")}var s={getXMLHttpRequestObject:function(){return window.XMLHttpRequest?new window.XMLHttpRequest:window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):null},sendGET:function(e,n,t,o){var i=f.jsonToQS(n,null),r=(new Date).getTime();if(0===t.cookieSettings)if("function"==typeof t.loadScript)t.loadScript(e+"?"+i+"&sy[st]="+r+"&sy[tt]=js-get",function(){g(t),"function"==typeof o&&o()});else{var a=document.getElementsByTagName("head")[0],c=t.cookieNamePrefix+"callback"+r,s=document.getElementById(t.cookieNamePrefix+"script");if(!s){var d=(new Date).setTime((new Date).getTime()+t.userCookieTimeout);(s=document.createElement("script")).setAttribute("id",t.cookieNamePrefix+"script"),s.type="text/javascript",s.innerText="function "+c+'(cduid) {console && console.log("CDUID callback after GET request: " + cduid);document.cookie = "'+t.cookieNamePrefix+'cduid = " + window.decodeURIComponent(cduid) + ";expires='+d+(t.cookiePath?";path="+t.cookiePath:"")+(t.cookieDomain?";domain="+t.cookieDomain:"")+'";}',a.appendChild(s)}var u=document.createElement("script");u.type="text/javascript",u.async=!0,u.defer=!0,u.src=e+"?"+i+"&task=get&callback="+c+"&sy[st]="+r+"&sy[tt]=js-get",a.appendChild(u),g(t),"function"==typeof o&&o()}else new Image(1,1).src=e+"?"+i+"&type=img&sy[st]="+r+"&sy[tt]=js-get",t.crossDomainUserId="not-supported",g(t),"function"==typeof o&&o(),l.setCookie(t.cookieNamePrefix+"cduid",t.crossDomainUserId,t.userCookieTimeout,t.cookiePath,t.cookieDomain,undefined)},sendPOST:function(t,o,i,r){try{i.crossDomainUserId===undefined&&A.lock();var a=this.getXMLHttpRequestObject();null!==a&&"withCredentials"in a&&(a.open("POST",t,!0),a.setRequestHeader("Content-Type","application/json; charset=UTF-8"),a.withCredentials=!0,a.onreadystatechange=function(){if(4===this.readyState)if(200<=this.status&&this.status<300){if(0<this.status){try{var e=JSON.parse(a.responseText);e.cduid!==undefined?i.crossDomainUserId=e.cduid:(c.warn("Server response contains no 3rd party cookie ID."),i.crossDomainUserId="server-response-contains-no-cduid")}catch(n){c.warn("Server response contains malformatted response."),i.crossDomainUserId="malformatted-server-response"}if("not-set"===i.crossDomainUserId){if(-1===t.indexOf("?check=1"))return void this.sendPOST(t+"?check=1",o,i,r);i.crossDomainUserId="not-accepted"}g(i),"function"==typeof r&&r()}}else this.sendGET(t,o,i,r),l.setCookie(i.cookieNamePrefix+"cduid","not-supported",i.userCookieTimeout,i.cookiePath,i.cookieDomain,undefined)},a.addEventListener("error",function(e){c.warn(e),"function"==typeof r&&r()}),o.sy.st=(new Date).getTime(),o.sy.tt="js-post",a.send(JSON.stringify([o])))}catch(e){c.warn("Error while sending: "+e),r!==undefined&&r()}},sendProfile:function(e,n,t,o,i){var r=this.getXMLHttpRequestObject();if(null!==r&&"withCredentials"in r){var a={};n&&(a.key=n),t&&(a.value=t),o&&(a.label=o),r.open("POST",e+"/profile"),r.setRequestHeader("Content-Type","application/json; charset=utf-8"),r.withCredentials=!0,"function"==typeof i&&(r.onreadystatechange=function(){4===this.readyState&&200<=this.status&&this.status<300&&i(JSON.parse(this.responseText))}),r.send(JSON.stringify(a))}else c.warn("Sending ids not supported by browser")}};function r(e){var n,t,o,i,r,a,c,s,d,u=function u(e,n){return e<<n|e>>>32-n},f=function f(e){for(var n="",t=7;0<=t;t--){n+=(e>>>4*t&15).toString(16)}return n},l=[],g=1732584193,p=4023233417,h=2562383102,m=271733878,w=3285377520,v=[];for(d=(e=unescape(window.encodeURIComponent(e))).length,n=0;n<d-3;n+=4)t=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),v.push(t);switch(3&d){case 0:n=2147483648;break;case 1:n=e.charCodeAt(d-1)<<24|8388608;break;case 2:n=e.charCodeAt(d-2)<<24|e.charCodeAt(d-1)<<16|32768;break;case 3:n=e.charCodeAt(d-3)<<24|e.charCodeAt(d-2)<<16|e.charCodeAt(d-1)<<8|128}for(v.push(n);14!=(15&v.length);)v.push(0);v.push(d>>>29),v.push(d<<3&4294967295);for(var k=0;k<v.length;k+=16){for(n=0;n<16;n++)l[n]=v[k+n];for(n=16;n<=79;n++)l[n]=u(l[n-3]^l[n-8]^l[n-14]^l[n-16],1);for(o=g,i=p,r=h,a=m,c=w,n=0;n<=19;n++)s=u(o,5)+(i&r|~i&a)+c+l[n]+1518500249&4294967295,c=a,a=r,r=u(i,30),i=o,o=s;for(n=20;n<=39;n++)s=u(o,5)+(i^r^a)+c+l[n]+1859775393&4294967295,c=a,a=r,r=u(i,30),i=o,o=s;for(n=40;n<=59;n++)s=u(o,5)+(i&r|i&a|r&a)+c+l[n]+2400959708&4294967295,c=a,a=r,r=u(i,30),i=o,o=s;for(n=60;n<=79;n++)s=u(o,5)+(i^r^a)+c+l[n]+3395469782&4294967295,c=a,a=r,r=u(i,30),i=o,o=s;g=g+o&4294967295,p=p+i&4294967295,h=h+r&4294967295,m=m+a&4294967295,w=w+c&4294967295}return(s=f(g)+f(p)+f(h)+f(m)+f(w)).toLowerCase()}var a=null,d=function(e,n){if(null===a&&(!1===(a=l.getCookie(e.cookieNamePrefix+"duid"))||a===undefined||null==a)){var t=(new Date).getTime();a=r(e.cookieDomain).substring(0,4)+"."+r((navigator.userAgent||"")+(navigator.platform||"")+t+Math.random()).slice(0,16)+"."+t,l.setCookie(e.cookieNamePrefix+"duid",a,e.userCookieTimeout,"/",e.cookieDomain,!1)}return"function"==typeof n&&n(a),a},u={},p={get:function I(){return u},set:function D(e){u=f.mergeRecursive(u,e)},reset:function U(e){var n;return u.hasOwnProperty(e)&&(n=u[e],delete u[e]),n},clear:function(){u={}}},h=s.getXMLHttpRequestObject(),m=r((new Date).getTime()+Math.random()).slice(0,8),w={},v={trackerUrl:"https://g.ab21.xyz",forceGET:!1,cookieNamePrefix:"_osb_",userCookieTimeout:15768e7,cookiePath:"/",cookieDomain:location.hostname.split(".").reverse().splice(0,2).reverse().join("."),cookieSettings:0,ipSettings:0,accountId:"development",namespace:undefined,siteId:undefined,loadScript:null,cduidLoaded:null};function k(e,n){c.log("Tracker `send` "+JSON.stringify(n)+" with config "+JSON.stringify(e));try{if(window.localStorage!==undefined){var t=window.localStorage.getItem(e.cookieNamePrefix+"cduid");null!==t&&(e.crossDomainUserId=t)}}catch(i){console.debug(i)}if(e.crossDomainUserId===undefined){A.lock();var o=function o(){A.unlock(),A.trigger()};null!==h&&"withCredentials"in h&&!1===e.forceGET?s.sendPOST(e.trackerUrl,n,e,o):s.sendGET(e.trackerUrl,n,e,o)}else null!==h&&"withCredentials"in h&&!1===e.forceGET?s.sendPOST(e.trackerUrl,n,e):s.sendGET(e.trackerUrl,n,e),A.trigger()}var y={createTracker:function(e,n){w[e]=f.mergeRecursive(v,n)},send:function P(e,n){for(var t in"string"==typeof n&&(n=n.split(",")),w)if(w.hasOwnProperty(t)){var o=w[t];if(n===undefined||n.includes(o.name)){var i={sy:{tv:"5.1",cs:o.cookieSettings!==undefined?o.cookieSettings:1,is:o.ipSettings!==undefined?o.ipSettings:0},pg:{vid:m,url:location.href,ref:document.referrer,ttl:document.title},duid:d(o),hits:[]};o.accountId&&(i.sy.aid=o.accountId),o.siteId&&(i.sy.sid=o.siteId),o.namespace&&(i.sy.ns=o.namespace);var r=p.get();f.isEmpty(r)||(i.data=r),i.hits.push(e),k(o,i)}else c.warn("Ignoring tracker "+t)}},getTrackers:function(){return w},getProfile:function(e,n,t,o,i){for(var r in w)if(w.hasOwnProperty(r)){var a=w[r];i!==undefined&&!i.includes(a.name)||s.sendProfile(a.trackerUrl,e,n,t,o)}},getDuid:function(e){for(var n in w)if(w.hasOwnProperty(n)&&w.hasOwnProperty(n)){var t=w[n];e(d(t))}}};function b(){c.log("Processing `create` "+JSON.stringify(f.args2array.apply(f,arguments)));var e=0,n=e<arguments.length?arguments[e++]:"development",t=e<arguments.length&&"string"==typeof arguments[e]?arguments[e++]:"default",o=e<arguments.length&&f.isObject(arguments[e])?arguments[e++]:{},i=e<arguments.length&&"function"==typeof arguments[e]?arguments[e++]:null,r={accountId:n,namespace:t};for(var a in o)switch(a){case"trackerUrl":case"forceGET":case"cookieNamePrefix":case"userCookieTimeout":case"cookiePath":case"cookieDomain":case"loadScript":case"cookieSettings":case"ipSettings":case"siteId":case"cduidLoaded":"cduidLoaded"===a&&c.log("cduidLoaded callback configured"),r[a]=o[a];break;default:c.warn("Invalid configuration `"+a+"`.")}c.log("Tracker config `"+JSON.stringify(r)+"`"),y.createTracker(t,r),null!==i&&i()}function T(e,n){var t=f.mergeRecursive({tp:"pageview",ht:(new Date).getTime()},{br:function i(){var e={tz:-1*(new Date).getTimezoneOffset(),sw:screen.width,sh:screen.height,iw:window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,ih:window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,ck:l.acceptsCookies()},n={pdf:"application/pdf",fla:"application/x-shockwave-flash",jv:"application/x-java-vm"};if(!/'MSIE'/.test(navigator.userAgent)){if(navigator.mimeTypes&&navigator.mimeTypes.length)for(var t in n)if(Object.prototype.hasOwnProperty.call(n,t)){var o=navigator.mimeTypes[n[t]];e[t]=o&&o.enabledPlugin?1:0}navigator.javaEnabled!==undefined&&navigator.javaEnabled()&&(e.jv=1)}return e}()},e?{data:e}:undefined);y.send(t,n)}function S(e,n,t){var o=f.mergeRecursive({tp:e,ht:(new Date).getTime()},n?{data:n}:undefined);y.send(o,t)}function C(e,n,t){y.getProfile(e.key,e.value,e.label,n,t)}function O(e,n,t){var o=f.mergeRecursive({tp:e,ht:(new Date).getTime()},n?{data:n}:undefined);y.send(o,t)}function P(){for(var e=arguments[0],n=[],t=1;t<arguments.length;t++)n.push(arguments[t]);switch(c.log("Processing `send` "+e+(0<n.length?" "+JSON.stringify(n[0]):"")),e){case"pageview":T.apply(void 0,n);break;case"event":S.apply(void 0,["event"].concat(n));break;case"ids":C.apply(void 0,n);break;case"action":O.apply(void 0,n);break;case"exception":S.apply(void 0,["exception"].concat(n));break;case"social":S.apply(void 0,["social"].concat(n));break;case"timing":S.apply(void 0,["timing"].concat(n))}"function"==typeof n[n.length-1]&&n[n.length-1]()}function D(){if(c.log("Processing `set` "+JSON.stringify(f.args2array.apply(f,arguments))),1===arguments.length&&f.isObject(arguments[0]))p.set(arguments[0]);else if(2===arguments.length&&"string"==typeof arguments[0]){var e={};e[arguments[0]]=arguments[1],p.set(e)}else c.warn("Invalid `set` command")}function I(){return c.log("Processing `get` "+JSON.stringify(f.args2array.apply(f,arguments))),p.get()}function E(e){c.log("Processing `dump` "+JSON.stringify(arguments));var n=y.getTrackers(),t=0;for(var o in n)if(n.hasOwnProperty(o)){var i=n[o];c.group(),c.log("Tracker `"+o+"` config:"),c.log(JSON.stringify(i)),c.log("Data:"),c.log(JSON.stringify(p.get())),c.groupEnd(),t++}0===t&&c.log("* No trackers")}function U(e){c.log("Processing `reset` "+JSON.stringify(f.args2array.apply(f,arguments)));return e?p.reset(e):p.clear()}function N(e){c.log("Processing `consent`");var n=!1,t=e&&e.cookieName?e.cookieName:"cc",o=e&&e.consentUrl?e.consentUrl:"http://localhost:3000/cookies",i=e&&e.duid?e.duid:"duid";if(l.getCookie(t))n=!0;else{var r=new URLSearchParams(window.location.search).get(i);r&&(n=!0,l.setCookie(t,r,15768e7,"/",window.location.hostname,window.location.href.startsWith("https")))}n?c.log("Cookie consent given"):window.location=o+(0<=o.indexOf("?")?"&":"?")+"target="+window.location}var j="osb:process",x=[],R=!1;function e(){window.dispatchEvent?window.dispatchEvent(new Event(j)):document.documentElement[j]++}function L(){if(R)c.warn("Queue locked");else for(;0<x.length;){var e=x.shift()[0];if(0<e.length){for(var n=e[0],t=[],o=1;o<e.length;o++)t.push(e[o]);switch(n){case"create":b.apply(void 0,t);break;case"set":D.apply(void 0,t);break;case"get":return I.apply(void 0,t);case"send":P.apply(void 0,t);break;case"dump":E.apply(void 0,t);break;case"reset":U.apply(void 0,t);break;case"duid":y.getDuid.apply(y,t);break;case"consent":N.apply(void 0,t);break;default:c.warn("Unknown command "+n)}}}}window.addEventListener?window.addEventListener(j,L):document.documentElement.attachEvent("onpropertychange",function(e){e.propertyName===j&&L()}),window.setInterval(function(){e()},5e3);for(var A={push:function(){x.push(arguments)},trigger:function(){e()},lock:function(){R=R||!0},unlock:function(){R=R&&!1}},J="$OSB_QUEUENAME",H=window[window[J]]!==undefined&&window[window[J]].q!==undefined?window[window[J]].q:[],M=0;M<H.length;M++)c.log("Pushing cached call "+JSON.stringify(H[M])),A.push(H[M]);window[J]=undefined;try{delete window[J]}catch(G){}A.trigger(),window.osb=function(){A.push(arguments),A.trigger()}}();
//# sourceMappingURL=osb.min.js.map
